I
shiny::runApp('Desktop/test')
runApp('Desktop/test')
help("phyper")
phyper(q = 298, m = 5878, n = 22523-5878,k=825,lower.tail = F)
phyper(q = 311, m = 5878, n = 22523-5878,k=1025,lower.tail = F)
phyper(q = 121, m = 1203, n = 27000-1203,k=1097,lower.tail = F)
library(clusterProfiler)
library(org.At.tair.db)
columns(org.At.tair.db)
select(org.At.tair.db,columns = c("SYMBOL"),keys=keys(org.At.tair.db,keytype = "TAIR"))[["SYMBOL"]]
compute.enrichments <- function(gene.ratios, bg.ratios)
{
gene.ratios.eval <- sapply(parse(text=gene.ratios),FUN = eval)
bg.ratios.eval <- sapply(parse(text=bg.ratios),FUN = eval)
enrichments <- round(x=gene.ratios.eval/bg.ratios.eval,digits = 2)
enrichments.text <- paste(enrichments, " (", gene.ratios, "; ", bg.ratios, ")",sep="")
return(enrichments.text)
}
setwd("~/Dropbox/github_repos/ATTRACTOR/presentations/ispp2019")
#genes <- read.table(file="genes_CCA1_PRR5_PIF5.txt",as.is=T)[[1]]
genes <- read.table(file="genes_PIF4_PHYA_PRR5.txt",as.is=T)[[1]]
length(genes)
atha.universe <- unique(select(org.At.tair.db,columns = c("GO"),keys=keys(org.At.tair.db,keytype = "TAIR"))[["TAIR"]])
length(atha.universe)
ego <- enrichGO(gene          = genes,
universe      = atha.universe,
OrgDb         = org.At.tair.db,
ont           = "BP",
pAdjustMethod = "BH",
pvalueCutoff  = 0.05,
qvalueCutoff  = 0.05,
readable      = FALSE,
keyType = "TAIR")
barplot(ego,drop=TRUE,showCategory = 20)
goplot(x=ego,showCategory = 10)
dotplot(ego,showCategory=20)
emapplot(ego,showCategory=20)
cnetplot(ego,showCategory=20)
## Generate ouput table
enrich.go.result <- as.data.frame(ego)
## GO term Description P-value Q-value Enrichment (SetRatio, BgRatio) Genes
go.term.enrichments <- compute.enrichments(gene.ratios = enrich.go.result$GeneRatio,
bg.ratios = enrich.go.result$BgRatio)
go.result.table <- data.frame(enrich.go.result$ID, enrich.go.result$Description,
enrich.go.result$pvalue, enrich.go.result$qvalue,
go.term.enrichments,
gsub(pattern = "/",replacement = " ",x = enrich.go.result$geneID),
stringsAsFactors = FALSE)
colnames(go.result.table) <- c("GO ID", "Description", "p-value", "q-value",
"Enrichment (Target Ratio; BG Ration)","Genes")
head(go.result.table)
write.table(x = go.result.table,file = "PIF4_PHYA_PRR5.txt",row.names = F,quote = F,sep = "\t")
shiny::runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/attractor_dev_stable')
runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/network_visualizer')
runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/attractor_dev_stable')
#genes <- read.table(file="genes_CCA1_PRR5_PIF5.txt",as.is=T)[[1]]
genes <- read.table(file="phyb_pif4_prr5/genes_PIF4_PHYA_PRR5.txt",as.is=T)[[1]]
length(genes)
atha.universe <- unique(select(org.At.tair.db,columns = c("GO"),keys=keys(org.At.tair.db,keytype = "TAIR"))[["TAIR"]])
length(atha.universe)
ego <- enrichGO(gene          = genes,
universe      = atha.universe,
OrgDb         = org.At.tair.db,
ont           = "BP",
pAdjustMethod = "BH",
pvalueCutoff  = 0.05,
qvalueCutoff  = 0.05,
readable      = FALSE,
keyType = "TAIR")
barplot(ego,drop=TRUE,showCategory = 20)
goplot(x=ego,showCategory = 10)
dotplot(ego,showCategory=20)
barplot(ego,drop=TRUE,showCategory = 20)
## Generate ouput table
enrich.go.result <- as.data.frame(ego)
## GO term Description P-value Q-value Enrichment (SetRatio, BgRatio) Genes
go.term.enrichments <- compute.enrichments(gene.ratios = enrich.go.result$GeneRatio,
bg.ratios = enrich.go.result$BgRatio)
go.result.table <- data.frame(enrich.go.result$ID, enrich.go.result$Description,
enrich.go.result$pvalue, enrich.go.result$qvalue,
go.term.enrichments,
gsub(pattern = "/",replacement = " ",x = enrich.go.result$geneID),
stringsAsFactors = FALSE)
colnames(go.result.table) <- c("GO ID", "Description", "p-value", "q-value",
"Enrichment (Target Ratio; BG Ration)","Genes")
head(go.result.table)
write.table(x = go.result.table,file = "phyb_pif4_prr5/PHYB_PIF4_PRR5.txt",row.names = F,quote = F,sep = "\t")
runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/network_visualizer')
runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/peak_visualizer')
#genes <- read.table(file="genes_CCA1_PRR5_PIF5.txt",as.is=T)[[1]]
genes <- read.table(file="CCA1_PIF4_LUX/genes_CCA1_PIF5_LUX.txt",as.is=T)[[1]]
length(genes)
atha.universe <- unique(select(org.At.tair.db,columns = c("GO"),keys=keys(org.At.tair.db,keytype = "TAIR"))[["TAIR"]])
length(atha.universe)
ego <- enrichGO(gene          = genes,
universe      = atha.universe,
OrgDb         = org.At.tair.db,
ont           = "BP",
pAdjustMethod = "BH",
pvalueCutoff  = 0.05,
qvalueCutoff  = 0.05,
readable      = FALSE,
keyType = "TAIR")
barplot(ego,drop=TRUE,showCategory = 20)
goplot(x=ego,showCategory = 10)
barplot(ego,drop=TRUE,showCategory = 20)
## Generate ouput table
enrich.go.result <- as.data.frame(ego)
## GO term Description P-value Q-value Enrichment (SetRatio, BgRatio) Genes
go.term.enrichments <- compute.enrichments(gene.ratios = enrich.go.result$GeneRatio,
bg.ratios = enrich.go.result$BgRatio)
go.result.table <- data.frame(enrich.go.result$ID, enrich.go.result$Description,
enrich.go.result$pvalue, enrich.go.result$qvalue,
go.term.enrichments,
gsub(pattern = "/",replacement = " ",x = enrich.go.result$geneID),
stringsAsFactors = FALSE)
colnames(go.result.table) <- c("GO ID", "Description", "p-value", "q-value",
"Enrichment (Target Ratio; BG Ration)","Genes")
head(go.result.table)
write.table(x = go.result.table,file = "CCA1_PIF4_LUX/CCA1_PIF4_LUX.txt",row.names = F,quote = F,sep = "\t")
runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/attractor_dev_stable')
runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/network_visualizer')
