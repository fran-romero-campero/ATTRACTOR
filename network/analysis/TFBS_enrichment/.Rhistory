tmp
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
File.list
i <- 1
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
setwd("~/Dropbox/estudio/R_packages")
File.list[i]
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
tmp<-read.table( file = File.list[i], stringsAsFactors = FALSE )
read.table( File.list[i], stringsAsFactors = FALSE )
read.table( File.list[i])
File.list
setwd("~/Dropbox/estudio/R_packages/bed_files")
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
file.metadata <- myMetaData[ myMetaData$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
myMetadata <- read.table(file = "metadata.txt", header = T)
read.table( File.list[i], stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
file.metadata
tmp
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
tmp
format
file.metadata
txt2GR(tmp, format, file.metadata)
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
myMetadata <- read.table(file = "../metadata.txt", header = T)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( File.list[i], stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
setwd("~/Dropbox/estudio/R_packages")
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
setwd("~/Dropbox/estudio/R_packages")
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
bed <- read.table(file = "bed_files/PIF3_peaks.narrowPeak")
head(bed)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
myMetadata
myMetadata$Name == File.list[i]
file.metadata
myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
txt2GR(fileTable = bed, format = "narrowpeak", fileMetaData = myMetadata)
seq_along(File.list)
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
tmp
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata
tmp
format
file.metadata
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
txt2GR(fileTable = bed, format = "narrowpeak", fileMetaData = myMetadata)
folder<-"bed_files/"
File.list<-dir(folder)
folder
File.list
format<-"narrowpeak"
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
head(myMetadata)
head(bed)
txt2GR(fileTable = bed, format = "narrowpeak", fileMetaData = myMetadata)
setwd("~/Dropbox/github_repos/ATTRACTOR/network/analysis/TFBS_enrichment")
folder<-"bed_files/"
setwd("~/Dropbox/github_repos/ATTRACTOR/network/analysis/TFBS_enrichment")
#Read the metadata table
# A Metadata table (storing at least, Accession ID, name of the file,
# and TF tested in the ChIP-Seq experiment). The metadata table included
# with this package has the following fields: “Name”, “Accession”, “Cell”,
# “Cell Type”, “Treatment”, “Antibody”, and “TF”.
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
txt2GR(fileTable = bed, format = "narrowpeak", fileMetaData = myMetadata)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
tmp
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
paste0(folder,File.list[i])
i <- 3
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
paste0(folder,File.list[i])
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
ChIP.dataset.gr
#Load package
library(TFEA.ChIP)
#Read the metadata table
# A Metadata table (storing at least, Accession ID, name of the file,
# and TF tested in the ChIP-Seq experiment). The metadata table included
# with this package has the following fields: “Name”, “Accession”, “Cell”,
# “Cell Type”, “Treatment”, “Antibody”, and “TF”.
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
bed <- read.table(file = "bed_files/CCA1_peaks.narrowPeak")
head(bed)
txt2GR(fileTable = bed, format = "narrowpeak", fileMetaData = myMetadata)
txt2GR(fileTable = bed, format = "macs", fileMetaData = myMetadata)
txt2GR(fileTable = bed, format = "macs1.4", fileMetaData = myMetadata)
txt2GR(fileTable = bed, format = "macs2", fileMetaData = myMetadata)
bed <- read.table(file = "bed_files/CCA1_peaks.narrowPeak")
head(bed)
#Convert to narrowpeak format (ten columns)
extra.column <- rep(x = ".", times=nrow(bed))
new.bed <- cbind(bed, extra.column)
new.bed
new.bed <- cbind(bed, rep(extra.column, 7))
new.bed
rep(extra.column, 7)
extra.columns <- matrix(nrow = nrow(bed), ncol = 7))
extra.columns <- matrix(nrow = nrow(bed), ncol = 7)
head(extra.columns)
new.bed <- cbind(bed, extra.columns)
new.bed
write.table(file="bed_files/CCA1_new_peaks.narrowPeak", sep = "\t")
write.table(new.bed, file="bed_files/CCA1_new_peaks.narrowPeak", sep = "\t")
write.table(new.bed, file="bed_files/CCA1_new_peaks.narrowPeak", sep = "\t",
col.names = FALSE, row.names = FALSE)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
i <- 1
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
tmp
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata
txt2GR(tmp, format, file.metadata)
i <- 2
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
tmp
file.metadata
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
i <- 1
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
tmp
file.metadata
ChIP.dataset.gr
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
}
File.list[i]
paste0(folder,File.list[i])
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
tmp
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
file.metadata
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
}
txt2GR.function <- function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
}
gr.list <- lapply(X = File.list, FUN = txt2GR.function, File.list, myMetadata, format)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(X = File.list, FUN = txt2GR.function, File.list, myMetadata, format)
gr.list <- lapply(X = File.list, FUN = txt2GR.function, File.list=File.list, myMetadata=myMetadata, format=format)
gr.list <- lapply(X = File.list, FUN = txt2GR.function)
folder<-"bed_files/"
File.list<-dir(folder)
seq_along(File.list)
File.list
setwd("~/Dropbox/github_repos/ATTRACTOR/network/analysis/TFBS_enrichment")
myMetadata
length(File.list)
#Read the metadata table
# A Metadata table (storing at least, Accession ID, name of the file,
# and TF tested in the ChIP-Seq experiment). The metadata table included
# with this package has the following fields: “Name”, “Accession”, “Cell”,
# “Cell Type”, “Treatment”, “Antibody”, and “TF”.
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetadata = myMetadata,
format = format
)
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
gr.list <- lapply(
seq_along(File.list),
File.list,
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
File.list[i]
i
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
ChIP.dataset.gr
lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
gr.list[i] <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
gr.list <- lapply(
seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
gr.list <- lapply(
# seq_along(File.list),
function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
},
File.list = File.list,
myMetaData = myMetadata,
format = format
)
txt2GR.fun <- function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
}
lapply(1:10, txt2GR.fun, File.list = File.list, myMetaData = myMetadata, format = format )
lapply(1:10, txt2GR.fun(File.list = File.list, myMetaData = myMetadata, format = format))
for (i in 1:length(File.list))
{
gr.list[i] <- txt2GR.fun(File.list = File.list, myMetaData = myMetadata, format="narrowpeak")
}
gr.list <- list()
for (i in 1:length(File.list))
{
gr.list[i] <- txt2GR.fun(File.list = File.list, myMetaData = myMetadata, format="narrowpeak")
}
gr.list
library(TxDb.Athaliana.BioMart.plantsmart28)
txdb <- TxDb.Athaliana.BioMart.plantsmart28
atha.genes <- genes(txdb)
TF.gene.binding.db <- GR2tfbs_db(atha.genes, gr.list, distanceMargin = 0)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GSEABase", version = "3.8")
library(GSEABase)
TF.gene.binding.db <- GR2tfbs_db(atha.genes, gr.list, distanceMargin = 0)
str(TF.gene.binding.db)
gen.list<-genes(txdb)$gene_id # selecting all the genes in knownGene
gen.list
myTFBSmatrix <- makeTFBSmatrix(gen.list,TF.gene.binding.db)
myTFBSmatrix[2530:2533,1:3] # The gene HMGN4 (Entrez ID 10473) has TFBS for this three ChIP-Seq datasets
myTFBSmatrix[2530,] # The gene HMGN4 (Entrez ID 10473) has TFBS for this three ChIP-Seq datasets
#Read the metadata table
# A Metadata table (storing at least, Accession ID, name of the file,
# and TF tested in the ChIP-Seq experiment). The metadata table included
# with this package has the following fields: “Name”, “Accession”, “Cell”,
# “Cell Type”, “Treatment”, “Antibody”, and “TF”.
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
folder<-"bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
#This function read the bed file, select the info from myMetaData and apply the txt2GR function
txt2GR.fun <- function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
}
#For loop
gr.list <- list()
for (i in 1:length(File.list))
{
gr.list[i] <- txt2GR.fun(File.list = File.list, myMetaData = myMetadata, format="narrowpeak")
}
TF.gene.binding.db <- GR2tfbs_db(atha.genes, gr.list, distanceMargin = 0) #asignation of peaks to genes
str(TF.gene.binding.db)
gen.list <- genes(txdb)$gene_id # selecting all the genes in knownGene
myTFBSmatrix <- makeTFBSmatrix(gen.list,TF.gene.binding.db)
myTFBSmatrix[2530,] # The gene HMGN4 (Entrez ID 10473) has TFBS for this three ChIP-Seq datasets
myTFBSmatrix[2530:2531,] # The gene HMGN4 (Entrez ID 10473) has TFBS for this three ChIP-Seq datasets
