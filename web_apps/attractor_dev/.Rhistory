plot_CM(pvalues)  #plot p-values against ORs (odd-ratios)
zt0.peak <- read.table("../../../clusters/peak_ZT0.txt", as.is = T)[[1]]
length(zt0.peak)
network.data <- read.table(file="../../../../web_apps/attractor_dev/data/attractor_network_representation.tsv",header = TRUE,as.is=TRUE,sep="\t",quote = "")
head(network.data)
all.genes <- network.data$names
length(all.genes)
my.list <- intersect(zt0.peak, all.genes)
length(my.list)
control.list <- setdiff(all.genes, my.list)
length(control.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
head(pvalues)
plot_CM(pvalues)  #plot p-values against ORs (odd-ratios)
zt0.peak <- read.table("../../../clusters/peak_ZT12_trough_ZT0.txt", as.is = T)[[1]]
length(zt0.peak)
network.data <- read.table(file="../../../../web_apps/attractor_dev/data/attractor_network_representation.tsv",header = TRUE,as.is=TRUE,sep="\t",quote = "")
head(network.data)
all.genes <- network.data$names
length(all.genes)
my.list <- intersect(zt0.peak, all.genes)
length(my.list)
control.list <- setdiff(all.genes, my.list)
length(control.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
head(pvalues)
plot_CM(pvalues)  #plot p-values against ORs (odd-ratios)
zt0.peak <- read.table("../../../clusters/peak_ZT0_trough_ZT16.txt", as.is = T)[[1]]
length(zt0.peak)
network.data <- read.table(file="../../../../web_apps/attractor_dev/data/attractor_network_representation.tsv",header = TRUE,as.is=TRUE,sep="\t",quote = "")
zt0.peak <- read.table("../../../clusters/peak_ZT0_trough_ZT12.txt", as.is = T)[[1]]
length(zt0.peak)
network.data <- read.table(file="../../../../web_apps/attractor_dev/data/attractor_network_representation.tsv",header = TRUE,as.is=TRUE,sep="\t",quote = "")
head(network.data)
all.genes <- network.data$names
length(all.genes)
my.list <- intersect(zt0.peak, all.genes)
length(my.list)
control.list <- setdiff(all.genes, my.list)
length(control.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
head(pvalues)
plot_CM(pvalues)  #plot p-values against ORs (odd-ratios)
subset(x = pvalues, ... = adj.p.value < 0.001)
help(subset)
subset(x = pvalues, subset = adj.p.value < 0.001)
length(File.list)
File.list
clusters.folder<-"../../../clusters/"
File.list<-dir(clusters.folder)
cluster.list<-dir(clusters.folder)
length(cluster.list)
paste0("../../../clusters/", cluster.list[i])
i <- 5
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
gene.list
my.list <- intersect(gene.peak, all.genes)
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
CM.list
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
cluster.list[i]
strsplit(x = cluster.list[i], split = "peak_")
strsplit(x = cluster.list[i], split = "peak_")[[1]][2]
i <- 1
split.1 <- strsplit(x = cluster.list[i], split = "peak_")[[1]][2]
split.1
cluster.list
split.1 <- strsplit(x = cluster.list[i], split = "_peak")[[1]][2]
i <- 7
split.1 <- strsplit(x = cluster.list[i], split = "_peak")[[1]][2]
split.1
split.1 <- strsplit(x = cluster.list[i], split = "peak_")[[1]][2]
split.1
strsplit(x = split.1, split = "ZT")
cluster.list[i]
strsplit(x = cluster.list[i], split = "peak_ZT")
i <- 8
strsplit(x = cluster.list[i], split = "peak_ZT")
strsplit(x = cluster.list[i], split = ".txt")
split.1 <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep, file=paste0("TFEA_tests/TFBS_enrichment",split.name))
}
setwd("~/Dropbox/github_repos/ATTRACTOR/network/analysis/TFBS_enrichment/TFEA")
i
paste0("../../../clusters/", cluster.list[i])
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep, file=paste0("TFEA_tests/TFBS_enrichment",split.name))
}
clusters.folder<-"../../../clusters/"
cluster.list<-dir(clusters.folder)
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep, file=paste0("TFEA_tests/TFBS_enrichment",split.name))
}
i
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
cluster.list[i]
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t", header=TRUE)
}
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t")
}
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t", row.names = FALSE)
}
i
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
gene.list
cluster.list[i]
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t", row.names = FALSE)
}
clusters.folder<-"../../../clusters/"
cluster.list<-dir(clusters.folder)
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t", row.names = FALSE)
}
i
cluster.list[i]
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t", row.names = FALSE)
}
clusters.folder<-"../../../clusters/"
cluster.list<-dir(clusters.folder)
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t", row.names = FALSE)
}
i
cluster.list[i]
clusters.folder<-"../../../clusters/"
cluster.list<-dir(clusters.folder)
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment",split.name),
sep="\t", row.names = FALSE)
}
setwd("~/Dropbox/github_repos/ATTRACTOR/network/analysis/TFBS_enrichment/TFEA")
myMetadata <- read.table(file = "metadata.txt", header = T)
head(myMetadata)
bed <- read.table(file = "CCA1_peaks.narrowPeak")
head(bed)
txt2GR(fileTable = bed, format = "narrowpeak", fileMetaData = myMetadata)
folder<-"../bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
#This function read the bed file, select the info from myMetaData and apply the txt2GR function
txt2GR.fun <- function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
}
#For loop
gr.list <- list()
for (i in 1:length(File.list))
{
gr.list[i] <- txt2GR.fun(File.list = File.list, myMetaData = myMetadata, format="narrowpeak")
}
#Load package
library(TFEA.ChIP)
txt2GR(fileTable = bed, format = "narrowpeak", fileMetaData = myMetadata)
folder<-"../bed_files/"
File.list<-dir(folder)
format<-"narrowpeak"
#This function read the bed file, select the info from myMetaData and apply the txt2GR function
txt2GR.fun <- function( File.list, myMetaData, format ){
tmp<-read.table( file = paste0(folder,File.list[i]), stringsAsFactors = FALSE )
file.metadata <- myMetadata[ myMetadata$Name == File.list[i], ]
ChIP.dataset.gr<-txt2GR(tmp, format, file.metadata)
return(ChIP.dataset.gr)
}
#For loop
gr.list <- list()
for (i in 1:length(File.list))
{
gr.list[i] <- txt2GR.fun(File.list = File.list, myMetaData = myMetadata, format="narrowpeak")
}
library(GSEABase)
library(TxDb.Athaliana.BioMart.plantsmart28)
txdb <- TxDb.Athaliana.BioMart.plantsmart28
atha.genes <- genes(txdb)
TF.gene.binding.db <- GR2tfbs_db(atha.genes, gr.list, distanceMargin = 0) #asignation of peaks to genes
str(TF.gene.binding.db)
txdb <- TxDb.Athaliana.BioMart.plantsmart28
atha.genes <- genes(txdb)
head(atha.genes)
help(GR2tfbs_db)
genes.data <- subset(genes(txdb,columns=c("tx_id", "tx_name","gene_id")))
head(genes.data)
head(genes.data)
head(atha.genes)
TF.gene.binding.db <- GR2tfbs_db(genes.data, gr.list, distanceMargin = 0) #asignation of peaks to genes
TF.gene.binding.db <- GR2tfbs_db(genes.data, gr.list, distanceMargin = 2000) #asignation of peaks to genes
str(TF.gene.binding.db)
gen.list <- genes(txdb)$gene_id # selecting all the genes in knownGene
myTFBSmatrix <- makeTFBSmatrix(gen.list,TF.gene.binding.db)
myTFBSmatrix[2530:2531,] # The gene AT1G23080 has TFBS for this five ChIP-Seq datasets
shiny::runApp('~/Dropbox/github_repos/ATTRACTOR/web_apps/peak_visualizer')
TF.gene.binding.db <- GR2tfbs_db(genes.data, gr.list, distanceMargin = 0) #asignation of peaks to genes
str(TF.gene.binding.db)
gen.list <- genes(txdb)$gene_id # selecting all the genes in knownGene
myTFBSmatrix <- makeTFBSmatrix(gen.list,TF.gene.binding.db)
myTFBSmatrix[2530:2531,] # The gene AT1G23080 has TFBS for this five ChIP-Seq datasets
TF.gene.binding.db <- GR2tfbs_db(genes.data, gr.list, distanceMargin = 2000) #asignation of peaks to genes
str(TF.gene.binding.db)
gen.list <- genes(txdb)$gene_id # selecting all the genes in knownGene
myTFBSmatrix <- makeTFBSmatrix(gen.list,TF.gene.binding.db)
myTFBSmatrix[2530:2531,] # The gene AT1G23080 has TFBS for this five ChIP-Seq datasets
set_user_data(binary_matrix = myTFBSmatrix, metadata = myMetadata)
help("set_user_data")
zt0.peak <- read.table("../../../clusters/peak_ZT0_trough_ZT12.txt", as.is = T)[[1]]
length(zt0.peak)
network.data <- read.table(file="../../../../web_apps/attractor_dev/data/attractor_network_representation.tsv",header = TRUE,as.is=TRUE,sep="\t",quote = "")
head(network.data)
all.genes <- network.data$names
length(all.genes)
my.list <- intersect(zt0.peak, all.genes)
length(my.list)
control.list <- setdiff(all.genes, my.list)
length(control.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
head(pvalues)
plot_CM(pvalues)  #plot p-values against ORs (odd-ratios)
clusters.folder<-"../../../clusters/"
cluster.list<-dir(clusters.folder)
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment_",split.name),
sep="\t", row.names = FALSE)
}
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment_",split.name),
sep="\t", row.names = FALSE)
}
paste0("TFEA_tests/TFBS_enrichment_",split.name)
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment_",split.name,"txt"),
sep="\t", row.names = FALSE)
}
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.001)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment_",split.name,".txt"),
sep="\t", row.names = FALSE)
}
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.05)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment_",split.name,".txt"),
sep="\t", row.names = FALSE)
}
i <- 1
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
CM.list
pvalues <- getCMstats(CM.list)
pvalues
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
# rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.05)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(pvalues,
# write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment_",split.name,".txt"),
sep="\t", row.names = FALSE)
}
i <- 24
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
cluster.list[i]
cluster.list
i <- 16
cluster.list[i]
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
my.list
control.list <- setdiff(all.genes, my.list)
control.list
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
CM.list
for (i in 1:length(cluster.list))
{
gene.list <- read.table(paste0("../../../clusters/", cluster.list[i]), as.is = T)[[1]]
my.list <- intersect(gene.list, all.genes)
control.list <- setdiff(all.genes, my.list)
CM.list <- contingency_matrix(test_list = my.list,
control_list = control.list, chip_index = myMetadata)
pvalues <- getCMstats(CM.list)
# rows.to.keep <- subset(x = pvalues, subset = adj.p.value < 0.05)
split.name <- strsplit(x = cluster.list[i], split = ".txt")[[1]]
write.table(pvalues,
# write.table(rows.to.keep,
file=paste0("TFEA_tests/TFBS_enrichment_",split.name,".txt"),
sep="\t", row.names = FALSE)
}
class(TF.gene.binding.db)
head(myTFBSmatrix)
write.table(myTFBSmatrix, file = "myTFBSmatrix.txt", header=TRUE, sep = "\t")
write.table(myTFBSmatrix, file = "myTFBSmatrix.txt", sep = "\t")
write.table(myTFBSmatrix, file = "myTFBSmatrix.txt", sep = "\t",row.names = TRUE)
setwd("~/Dropbox/github_repos/ATTRACTOR/web_apps/attractor_dev")
## Load database for TFEA analysis
myTFBSmatrix <- read.table(file = "data/myTFBSmatrix.txt", header = TRUE, sep = "\t")
head(myTFBSmatrix)
myTFBSmatrix <- makeTFBSmatrix(gen.list,TF.gene.binding.db)
head(myTFBSmatrix)
write.table(myTFBSmatrix, file = "myTFBSmatrix.txt",
sep = "\t",row.names = TRUE)
## Load database for TFEA analysis
myTFBSmatrix <- read.table(file = "data/myTFBSmatrix.txt", header = TRUE, sep = "\t")
head(myTFBSmatrix)
colnames(myTFBSmatrix) <- myTFBSmatrix$X
myTFBSmatrix$X
length(myTFBSmatrix$X)
nrow(myTFBSmatrix)
rownames(myTFBSmatrix) <- myTFBSmatrix$X
myTFBSmatrix$X <- NULL
myMetadata <- read.table(file = "data/metadata.txt", header = T)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
